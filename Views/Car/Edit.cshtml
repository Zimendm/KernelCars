@model KernelCars.Models.Car

<h1>Edit</h1>

<script type="text/javascript">
        $(document).ready(function () {
            var url = "/Car/GetCarOwnerList";
            var manufacturerId = 1;
            $.getJSON(url, { ManufacturerId: manufacturerId}, function (data) {
                $.each(data, function (i, cartype) {
                    //alert("Hello");
                    //$.each(data, function (i, item) {
                    //$("#owners").append($("<option>").attr('value', cartype.value).text(cartype.text));
                    //$("#owners").append($("<option>").attr('value',cartype.value).text(cartype.text));
                    $("#owners").append($("<option>").text(cartype.text));
                    //});
                });
            });
            //var url = "/Car/GetCarTypeList";
            //$.getJSON(url, { ManufacturerId: "3" }, function (data) {
            //    $.each(data, function (i, cartype) {
            //        alert(cartype.text);
            //    });
            //});
            //$.getJSON(url1, { ManufacturerId: manufacturerId }, function (data) {
                //$("#carTypeList").empty();
                //var item = "<option value='0'>-- Выберите модель --</option>";
                //$.each(data, function (i, cartype) {
                //    item += '<option value="' + cartype.text + '">' + '</option>'
                //});
                //$("#owners").html(item);
                //// se.show();
                // se[0].clientHeight = 2;

            $("#image").click(function () {
                //$(this).rotate(90);
                //alert("Rotate");

                var angle = ($(this).data('angle') + 90) || 90;
                $(this).css({ 'transform': 'rotate(' + angle + 'deg)' });
                $(this).data('angle', angle);
                $(this).css({ 'margin-top': 0});
                //$(this).css({ 'max-height':'400px'});

            });

            //});


        $("#manufacturerList").change(function () {
            var manufacturerId = $("#manufacturerList").val();
            //$("#carTypeList").simulate('mousedown');
            var url = "/Car/GetCarTypeList";
            $.getJSON(url, { ManufacturerId: manufacturerId }, function (data) {
                $("#carTypeList").empty();
                var item = "<option value='0'>-- Выберите модель --</option>";
                $.each(data, function (i, cartype) {

                    item += '<option value="' + cartype.value + '">' + cartype.text + '</option>'

               });
                $("#carTypeList").html(item);

                //var nameArray = ["Rick Bross", "Madison Smith", "Jack Johnson"];

                //                Add options to the datalist.
                //- "attr" helps if you need an i.d to identify each option.
                //- "text" is the content to be displayed.

                //$.each(data, function (i, item) {
                //    $("#owners").append($("<option>").attr('value', i.value).text(item.text));
                //});

               // se.show();
               // se[0].clientHeight = 2;

            });
            //$("#carTypeList").trigger('mousedown');







        });
            //$("#ownerList").keyup(function () {
            //    var elem = $("<option value='Udo'></option>");
            //    $("owners").add(elem);
            //});
       });
</script>


<script>
    // Add the following code if you want the name of the file appear on select
    $(".custom-file-input").on("change", function () {
        var fileName = $(this).val().split("\\").pop();
        $(this).siblings(".custom-file-label").addClass("selected").html(fileName);
    });
</script>




<div class="row">
    <div class="col-md-4">
        <form enctype="multipart/form-data" asp-action="Edit">
            <input type="hidden" asp-for="Id" />
            @*<div class="form-group">
            <label asp-for="Id" class="control-label"></label>
            <div>@Html.DisplayFor(model => model.Id)</div>
        </div>*@
            @*<div class="form-group">*@
            <div class="row">
                <div class="col-6">
                    <label asp-for="RegistrationNumber" class="control-label"></label>
                    <input asp-for="RegistrationNumber" class="form-control" />
                </div>
                <div class="col-6">
                    <label asp-for="VinNumber" class="control-label"></label>
                    <input asp-for="VinNumber" class="form-control" />
                </div>
            </div>
            @*</div>*@
            <div class="form-group">
                <div class="row">
                    <div class="col-6">
                        <label class="control-label">Производитель</label>
                        <select asp-for="CarModel.ManufacturerId" class="form-control" asp-items="ViewBag.ManufacturerId" id="manufacturerList">
                            <option value="">-- Выберите --</option>
                        </select>
                    </div>
                    <div class="col-6">
                        <label lass="control-label">Модель</label>
                        <select asp-for="CarModelId" class="form-control" asp-items="ViewBag.CarModelId" id="carTypeList">
                            <option value="">-- Выберите --</option>
                        </select>
                    </div>
                    @*<span asp-validation-for="DepartmentID" class="text-danger" />*@
                </div>
            </div>
            <div class="form-group">

                @*<span asp-validation-for="DepartmentID" class="text-danger" />*@
            </div>
            <div class="form-group">

            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-6">
                        <label asp-for="EngineCapacity" class="control-label"></label>
                        <input asp-for="EngineCapacity" class="form-control" />
                    </div>
                    <div class="col-6">
                        <label asp-for="Tyres" class="control-label"></label>
                        <input asp-for="Tyres" class="form-control" />
                    </div>
                </div>

            </div>
            <div class="form-group">
                <label asp-for="TankCapacity" class="control-label"></label>
                <input asp-for="TankCapacity" class="form-control" />
            </div>
            <div class="form-group">
                <label asp-for="LPG" class="control-label"></label>
                <input asp-for="LPG" class="form-control" />
            </div>
            <div class="form-group row">
                <div class="col-md-12">
                    <label>Техпаспорт. Сторона 1</label>
                    <div class="custom-file">
                        <input type="file" class="form-control custom-file-input" asp-for="ImagePage1" />
                        <label class="custom-file-label">Choose file...</label>
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-md-12">
                    <label>Техпаспорт. Сторона 2</label>
                    <div class="custom-file">
                        <input type="file" class="form-control custom-file-input" asp-for="ImagePage2" />
                        <label class="custom-file-label">Choose file...</label>
                    </div>
                </div>
            </div>
            <script>
                // Add the following code if you want the name of the file appear on select
                $(".custom-file-input").on("change", function () {
                    var fileName = $(this).val().split("\\").pop();
                    $(this).siblings(".custom-file-label").addClass("selected").html(fileName);
                });
            </script>
            <div>
                <input asp-for="CarOwner.FullName" list="owners" class="form-control" name="owners" id="ownerList" />
                <datalist id="owners"></datalist>
            </div>

            <div class="container">
                <div class="row">
                    <div style="height:600px">
                        @{
                            try
                            {
                                var base64 = Convert.ToBase64String(Model.ImagePage1);
                                var imgsrc = string.Format("data:image/jpg;base64,{0}", base64);
                                <img src="@imgsrc" class="img-thumbnail" id="image" style="width:200px;height:200px" />
                            }
                            catch (Exception)
                            {
                                //throw;
                            }

                        }



                        @Html.ActionLink("Download", "DownloadFile")
                    </div>
                </div>
            </div>

            <div class="form-group">
                <input type="submit" value="Save" class="btn btn-primary" />
            </div>
        </form>

    </div>
</div>